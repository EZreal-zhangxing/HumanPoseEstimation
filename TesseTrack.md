# TesseTrack

## Introduction

**一种在公共体素化特征空间运行的新时空公式**，通过将每帧深度学习的特征转化成离散的3D体素容积

1. 3D CNN定位在体素容积内的每个人的位置
2. 对每个人用一个4D CNN计算短期人的特定表示，生成一个固定的时空容积。相邻时间步的重叠表示进一步被基于注意力的聚合所打分，并使用不同的匹配器来连接
3. 同一个人的3D 关节，以基于合并特定人的表示在每个时间步骤里连续一致的被预测

第二个贡献：**新颖的可学习跟踪公式**，可以将任意一个人的时空表示学习拓展到任意时间长的序列中

这个跟踪公式与文献[49] 使用匈牙利算法做姿势距离的匹配（启发式成对追踪）不一样。我们依赖的是基于 Sinkhorn 算法的注意力聚集层和可区分的表示匹配层。重要的是**我们匹配的是人的特征而不是身体姿态轨迹**。

## Related Work

单人三维姿态追踪可分为多视图和单视图的方法

## TesseTrack

网络由三个部分构成，每个部分都有相关联的损失

1. 第一个部分是在3D空间中人体的检测，然后通过4D CNN 提取每个人的短期时空表示
2. 解决 两帧之间描述符分配的问题：$t $ 和 $ t+\Delta t$
3. 将所有匹配的描述符反卷积到中间帧的人的3D姿态，那些重叠的描述符并且会合并成为一个描述符

## Block One (Person detection Network)

这个模块是一个多视角人物检测网络（multi-view person detection network--PDN）

BackBone: HRNet

使用网络的Pre-final层，通过一个卷积层转换成大小为$R$ 的特征图

然后所有视角的特征图通过逆图像映射方法聚集到3D空间上

使用相机校准数据，并每个体素中心都会被投影到相机视图。将图像空间中的所有特征向量$Concat$起来，通过一个带有$softmax$ 层的浅层网络来聚集这些特征向量。这样会生成一个唯一的尺寸为$R$的特征向量。最后得到一个$R \times W \times H \times D$维度的数据，$W,H,D$为体素空间的维度，然后在这个数据上应用3D卷积，来训练网络检测中心的能力，这个中心就是人体颈部和臀部的中心点。损失即为：预测热图和输出热图的距离。类似CenterNet方法。
$$
L_D^t = \sum_{w=1}^W\sum_{h=1}^H\sum_{d=1}^D||V_{Pred} - V_{GT}||
$$
并且在3D热图上应用非极大值抑制，保留分数较大的预测

## Block Two (Spatio-Temporal Descriptors and Tracking)

对于检测到的人创建一个固定维度的时空体，然后使用4D CNN在检测帧生成一个短期的表示，我们将该网络称之为$Tesseract$,维度为$R \times T \times X \times Y \times Z$，$T$为空间窗口大小，$X,Y,Z$为检测人的立方体的中心维度

扩充空间信息的目的有两个

1. 使用空间上下文可以更好的在中心帧估计关节点的位置
2. 及时生成人的描述信息可以生成与相邻帧重叠的描述符，这样可以通过相似性来进行追踪

### Tesseract

该网络的输入是：$HRNet$中将每个时间戳投射成3D的pre-final层

和Block One的过程相似。然后通过多头4D卷积核最大池化层，来生成降低尺寸的tesseract 特征



